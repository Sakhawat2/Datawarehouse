<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <title>🎞️ Video Management</title>
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet">
  <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
  <style>
    body {
      font-family: 'Inter', sans-serif;
      background-color: #f8f9fa;
    }
    h1 {
      font-weight: 700;
    }
    .card {
      border: none;
      border-radius: 16px;
      box-shadow: 0 4px 10px rgba(0, 0, 0, 0.08);
    }
    th {
      background: #0d6efd;
      color: #fff;
      text-align: center;
    }
    td {
      text-align: center;
      vertical-align: middle;
    }
    video {
      width: 100%;
      height: auto;
      border-radius: 10px;
    }
  </style>
</head>

<body>
  <div class="container py-4">
    <!-- Header -->
    <div class="d-flex justify-content-between align-items-center mb-3">
      <h1>🎞️ Video Management</h1>
      <a href="/admin/" class="btn btn-outline-primary btn-sm">← Back to Dashboard</a>
    </div>

    <!-- Video Chart -->
    <div class="card p-3 mb-4">
      <h5>📊 Video Size Distribution</h5>
      <canvas id="videoChart" height="200"></canvas>
    </div>

    <!-- Video Table -->
    <div class="card p-3">
      <h5>📁 Uploaded Videos</h5>
      <div class="table-responsive mt-2">
        <table class="table table-bordered table-striped table-hover align-middle">
          <thead class="table-primary">
            <tr>
              <th>Filename</th>
              <th>Size (MB)</th>
              <th>Preview</th>
              <th>Download</th>
              <th>Action</th>
            </tr>
          </thead>
          <tbody id="videoTableBody">
            <tr><td colspan="5" class="text-center text-muted">Loading...</td></tr>
          </tbody>
        </table>
      </div>
    </div>

    <!-- Upload Section -->
    <div class="card p-3 mt-4">
      <h5>📤 Upload New Video</h5>
      <form id="uploadForm" class="d-flex align-items-center gap-2">
        <input type="file" id="videoFile" class="form-control" accept="video/mp4" required>
        <button type="submit" class="btn btn-success">Upload</button>
      </form>
    </div>
  </div>

  <!-- 🎥 Video Preview Modal -->
  <div class="modal fade" id="videoModal" tabindex="-1" aria-hidden="true">
    <div class="modal-dialog modal-dialog-centered modal-lg">
      <div class="modal-content">
        <div class="modal-header">
          <h5 class="modal-title">🎬 Video Preview</h5>
          <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
        </div>
        <div class="modal-body">
          <video id="previewVideo" controls></video>
        </div>
      </div>
    </div>
  </div>

  <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/js/bootstrap.bundle.min.js"></script>
  <script src="/admin/static/videos.js"></script>


  <script src="/admin/static/auth.js"></script>
<script>
  // 🚨 Ensure user is logged in
  checkAuth();

  // Show logout button dynamically
  document.addEventListener("DOMContentLoaded", () => {
    const navbar = document.querySelector(".navbar") || document.querySelector(".d-flex");
    if (navbar) {
      const btn = document.createElement("button");
      btn.textContent = "🚪 Logout";
      btn.className = "btn btn-outline-danger btn-sm ms-3";
      btn.onclick = logout;
      navbar.appendChild(btn);
    }
  });
</script>

</body>
</html>
